#include <stdio.h>
#include <stdlib.h>
#include "../Util.h"
#include "../timer.h"
#include "../Monty.h"
#include "../Multiply.h"

void forward_path(int* X,int* Y,monty_str* monty){
    Y[0] = X[0];
    Y[1] = X[16];
    Y[2] = X[1];
    Y[3] = X[17];
    Y[4] = X[2];
    Y[5] = X[18];
    Y[6] = X[3];
    Y[7] = X[19];
    Y[8] = X[4];
    Y[9] = X[20];
    Y[10] = X[5];
    Y[11] = X[21];
    Y[12] = X[6];
    Y[13] = X[22];
    Y[14] = X[7];
    Y[15] = X[23];
    Y[16] = X[8];
    Y[17] = X[24];
    Y[18] = X[9];
    Y[19] = X[25];
    Y[20] = X[10];
    Y[21] = X[26];
    Y[22] = X[11];
    Y[23] = X[27];
    Y[24] = X[12];
    Y[25] = X[28];
    Y[26] = X[13];
    Y[27] = X[29];
    Y[28] = X[14];
    Y[29] = X[30];
    Y[30] = X[15];
    Y[31] = X[31];
    X[0] = (Y[0] + REDC(monty,(108 * Y[1])));
    X[1] = (Y[0] + REDC(monty,(85 * Y[1])));
    X[2] = (Y[2] + REDC(monty,(108 * Y[3])));
    X[3] = (Y[2] + REDC(monty,(85 * Y[3])));
    X[4] = (Y[4] + REDC(monty,(108 * Y[5])));
    X[5] = (Y[4] + REDC(monty,(85 * Y[5])));
    X[6] = (Y[6] + REDC(monty,(108 * Y[7])));
    X[7] = (Y[6] + REDC(monty,(85 * Y[7])));
    X[8] = (Y[8] + REDC(monty,(108 * Y[9])));
    X[9] = (Y[8] + REDC(monty,(85 * Y[9])));
    X[10] = (Y[10] + REDC(monty,(108 * Y[11])));
    X[11] = (Y[10] + REDC(monty,(85 * Y[11])));
    X[12] = (Y[12] + REDC(monty,(108 * Y[13])));
    X[13] = (Y[12] + REDC(monty,(85 * Y[13])));
    X[14] = (Y[14] + REDC(monty,(108 * Y[15])));
    X[15] = (Y[14] + REDC(monty,(85 * Y[15])));
    X[16] = (Y[16] + REDC(monty,(108 * Y[17])));
    X[17] = (Y[16] + REDC(monty,(85 * Y[17])));
    X[18] = (Y[18] + REDC(monty,(108 * Y[19])));
    X[19] = (Y[18] + REDC(monty,(85 * Y[19])));
    X[20] = (Y[20] + REDC(monty,(108 * Y[21])));
    X[21] = (Y[20] + REDC(monty,(85 * Y[21])));
    X[22] = (Y[22] + REDC(monty,(108 * Y[23])));
    X[23] = (Y[22] + REDC(monty,(85 * Y[23])));
    X[24] = (Y[24] + REDC(monty,(108 * Y[25])));
    X[25] = (Y[24] + REDC(monty,(85 * Y[25])));
    X[26] = (Y[26] + REDC(monty,(108 * Y[27])));
    X[27] = (Y[26] + REDC(monty,(85 * Y[27])));
    X[28] = (Y[28] + REDC(monty,(108 * Y[29])));
    X[29] = (Y[28] + REDC(monty,(85 * Y[29])));
    X[30] = (Y[30] + REDC(monty,(108 * Y[31])));
    X[31] = (Y[30] + REDC(monty,(85 * Y[31])));
    Y[0] = X[0];
    Y[1] = X[2];
    Y[2] = X[4];
    Y[3] = X[6];
    Y[4] = X[8];
    Y[5] = X[10];
    Y[6] = X[12];
    Y[7] = X[14];
    Y[8] = X[16];
    Y[9] = X[18];
    Y[10] = X[20];
    Y[11] = X[22];
    Y[12] = X[24];
    Y[13] = X[26];
    Y[14] = X[28];
    Y[15] = X[30];
    Y[16] = X[1];
    Y[17] = X[3];
    Y[18] = X[5];
    Y[19] = X[7];
    Y[20] = X[9];
    Y[21] = X[11];
    Y[22] = X[13];
    Y[23] = X[15];
    Y[24] = X[17];
    Y[25] = X[19];
    Y[26] = X[21];
    Y[27] = X[23];
    Y[28] = X[25];
    Y[29] = X[27];
    Y[30] = X[29];
    Y[31] = X[31];
    X[0] = Y[0];
    X[1] = Y[1];
    X[2] = Y[2];
    X[3] = Y[3];
    X[4] = Y[4];
    X[5] = Y[5];
    X[6] = Y[6];
    X[7] = Y[7];
    X[8] = Y[8];
    X[9] = Y[9];
    X[10] = Y[10];
    X[11] = Y[11];
    X[12] = Y[12];
    X[13] = Y[13];
    X[14] = Y[14];
    X[15] = Y[15];
    X[16] = Y[16];
    X[17] = Y[17];
    X[18] = Y[18];
    X[19] = Y[19];
    X[20] = Y[20];
    X[21] = Y[21];
    X[22] = Y[22];
    X[23] = Y[23];
    X[24] = Y[24];
    X[25] = Y[25];
    X[26] = Y[26];
    X[27] = Y[27];
    X[28] = Y[28];
    X[29] = Y[29];
    X[30] = Y[30];
    X[31] = Y[31];
    Y[0] = (X[0] + REDC(monty,(7 * X[8])));
    Y[8] = (X[0] + REDC(monty,(186 * X[8])));
    Y[1] = (X[1] + REDC(monty,(7 * X[9])));
    Y[9] = (X[1] + REDC(monty,(186 * X[9])));
    Y[2] = (X[2] + REDC(monty,(7 * X[10])));
    Y[10] = (X[2] + REDC(monty,(186 * X[10])));
    Y[3] = (X[3] + REDC(monty,(7 * X[11])));
    Y[11] = (X[3] + REDC(monty,(186 * X[11])));
    Y[4] = (X[4] + REDC(monty,(7 * X[12])));
    Y[12] = (X[4] + REDC(monty,(186 * X[12])));
    Y[5] = (X[5] + REDC(monty,(7 * X[13])));
    Y[13] = (X[5] + REDC(monty,(186 * X[13])));
    Y[6] = (X[6] + REDC(monty,(7 * X[14])));
    Y[14] = (X[6] + REDC(monty,(186 * X[14])));
    Y[7] = (X[7] + REDC(monty,(7 * X[15])));
    Y[15] = (X[7] + REDC(monty,(186 * X[15])));
    Y[16] = (X[16] + REDC(monty,(12 * X[24])));
    Y[24] = (X[16] + REDC(monty,(181 * X[24])));
    Y[17] = (X[17] + REDC(monty,(12 * X[25])));
    Y[25] = (X[17] + REDC(monty,(181 * X[25])));
    Y[18] = (X[18] + REDC(monty,(12 * X[26])));
    Y[26] = (X[18] + REDC(monty,(181 * X[26])));
    Y[19] = (X[19] + REDC(monty,(12 * X[27])));
    Y[27] = (X[19] + REDC(monty,(181 * X[27])));
    Y[20] = (X[20] + REDC(monty,(12 * X[28])));
    Y[28] = (X[20] + REDC(monty,(181 * X[28])));
    Y[21] = (X[21] + REDC(monty,(12 * X[29])));
    Y[29] = (X[21] + REDC(monty,(181 * X[29])));
    Y[22] = (X[22] + REDC(monty,(12 * X[30])));
    Y[30] = (X[22] + REDC(monty,(181 * X[30])));
    Y[23] = (X[23] + REDC(monty,(12 * X[31])));
    Y[31] = (X[23] + REDC(monty,(181 * X[31])));
    X[0] = (Y[0] + REDC(monty,(172 * Y[4])));
    X[4] = (Y[0] + REDC(monty,(21 * Y[4])));
    X[1] = (Y[1] + REDC(monty,(172 * Y[5])));
    X[5] = (Y[1] + REDC(monty,(21 * Y[5])));
    X[2] = (Y[2] + REDC(monty,(172 * Y[6])));
    X[6] = (Y[2] + REDC(monty,(21 * Y[6])));
    X[3] = (Y[3] + REDC(monty,(172 * Y[7])));
    X[7] = (Y[3] + REDC(monty,(21 * Y[7])));
    X[8] = (Y[8] + REDC(monty,(157 * Y[12])));
    X[12] = (Y[8] + REDC(monty,(36 * Y[12])));
    X[9] = (Y[9] + REDC(monty,(157 * Y[13])));
    X[13] = (Y[9] + REDC(monty,(36 * Y[13])));
    X[10] = (Y[10] + REDC(monty,(157 * Y[14])));
    X[14] = (Y[10] + REDC(monty,(36 * Y[14])));
    X[11] = (Y[11] + REDC(monty,(157 * Y[15])));
    X[15] = (Y[11] + REDC(monty,(36 * Y[15])));
    X[16] = (Y[16] + REDC(monty,(62 * Y[20])));
    X[20] = (Y[16] + REDC(monty,(131 * Y[20])));
    X[17] = (Y[17] + REDC(monty,(62 * Y[21])));
    X[21] = (Y[17] + REDC(monty,(131 * Y[21])));
    X[18] = (Y[18] + REDC(monty,(62 * Y[22])));
    X[22] = (Y[18] + REDC(monty,(131 * Y[22])));
    X[19] = (Y[19] + REDC(monty,(62 * Y[23])));
    X[23] = (Y[19] + REDC(monty,(131 * Y[23])));
    X[24] = (Y[24] + REDC(monty,(189 * Y[28])));
    X[28] = (Y[24] + REDC(monty,(4 * Y[28])));
    X[25] = (Y[25] + REDC(monty,(189 * Y[29])));
    X[29] = (Y[25] + REDC(monty,(4 * Y[29])));
    X[26] = (Y[26] + REDC(monty,(189 * Y[30])));
    X[30] = (Y[26] + REDC(monty,(4 * Y[30])));
    X[27] = (Y[27] + REDC(monty,(189 * Y[31])));
    X[31] = (Y[27] + REDC(monty,(4 * Y[31])));
    Y[0] = (X[0] + REDC(monty,(75 * X[2])));
    Y[2] = (X[0] + REDC(monty,(118 * X[2])));
    Y[1] = (X[1] + REDC(monty,(75 * X[3])));
    Y[3] = (X[1] + REDC(monty,(118 * X[3])));
    Y[4] = (X[4] + REDC(monty,(101 * X[6])));
    Y[6] = (X[4] + REDC(monty,(92 * X[6])));
    Y[5] = (X[5] + REDC(monty,(101 * X[7])));
    Y[7] = (X[5] + REDC(monty,(92 * X[7])));
    Y[8] = (X[8] + REDC(monty,(137 * X[10])));
    Y[10] = (X[8] + REDC(monty,(56 * X[10])));
    Y[9] = (X[9] + REDC(monty,(137 * X[11])));
    Y[11] = (X[9] + REDC(monty,(56 * X[11])));
    Y[12] = (X[12] + REDC(monty,(97 * X[14])));
    Y[14] = (X[12] + REDC(monty,(96 * X[14])));
    Y[13] = (X[13] + REDC(monty,(97 * X[15])));
    Y[15] = (X[13] + REDC(monty,(96 * X[15])));
    Y[16] = (X[16] + REDC(monty,(168 * X[18])));
    Y[18] = (X[16] + REDC(monty,(25 * X[18])));
    Y[17] = (X[17] + REDC(monty,(168 * X[19])));
    Y[19] = (X[17] + REDC(monty,(25 * X[19])));
    Y[20] = (X[20] + REDC(monty,(95 * X[22])));
    Y[22] = (X[20] + REDC(monty,(98 * X[22])));
    Y[21] = (X[21] + REDC(monty,(95 * X[23])));
    Y[23] = (X[21] + REDC(monty,(98 * X[23])));
    Y[24] = (X[24] + REDC(monty,(83 * X[26])));
    Y[26] = (X[24] + REDC(monty,(110 * X[26])));
    Y[25] = (X[25] + REDC(monty,(83 * X[27])));
    Y[27] = (X[25] + REDC(monty,(110 * X[27])));
    Y[28] = (X[28] + REDC(monty,(32 * X[30])));
    Y[30] = (X[28] + REDC(monty,(161 * X[30])));
    Y[29] = (X[29] + REDC(monty,(32 * X[31])));
    Y[31] = (X[29] + REDC(monty,(161 * X[31])));
    X[0] = (Y[0] + REDC(monty,(155 * Y[1])));
    X[1] = (Y[0] + REDC(monty,(38 * Y[1])));
    X[2] = (Y[2] + REDC(monty,(183 * Y[3])));
    X[3] = (Y[2] + REDC(monty,(10 * Y[3])));
    X[4] = (Y[4] + REDC(monty,(103 * Y[5])));
    X[5] = (Y[4] + REDC(monty,(90 * Y[5])));
    X[6] = (Y[6] + REDC(monty,(149 * Y[7])));
    X[7] = (Y[6] + REDC(monty,(44 * Y[7])));
    X[8] = (Y[8] + REDC(monty,(77 * Y[9])));
    X[9] = (Y[8] + REDC(monty,(116 * Y[9])));
    X[10] = (Y[10] + REDC(monty,(132 * Y[11])));
    X[11] = (Y[10] + REDC(monty,(61 * Y[11])));
    X[12] = (Y[12] + REDC(monty,(30 * Y[13])));
    X[13] = (Y[12] + REDC(monty,(163 * Y[13])));
    X[14] = (Y[14] + REDC(monty,(79 * Y[15])));
    X[15] = (Y[14] + REDC(monty,(114 * Y[15])));
    X[16] = (Y[16] + REDC(monty,(111 * Y[17])));
    X[17] = (Y[16] + REDC(monty,(82 * Y[17])));
    X[18] = (Y[18] + REDC(monty,(80 * Y[19])));
    X[19] = (Y[18] + REDC(monty,(113 * Y[19])));
    X[20] = (Y[20] + REDC(monty,(141 * Y[21])));
    X[21] = (Y[20] + REDC(monty,(52 * Y[21])));
    X[22] = (Y[22] + REDC(monty,(159 * Y[23])));
    X[23] = (Y[22] + REDC(monty,(34 * Y[23])));
    X[24] = (Y[24] + REDC(monty,(156 * Y[25])));
    X[25] = (Y[24] + REDC(monty,(37 * Y[25])));
    X[26] = (Y[26] + REDC(monty,(102 * Y[27])));
    X[27] = (Y[26] + REDC(monty,(91 * Y[27])));
    X[28] = (Y[28] + REDC(monty,(146 * Y[29])));
    X[29] = (Y[28] + REDC(monty,(47 * Y[29])));
    X[30] = (Y[30] + REDC(monty,(140 * Y[31])));
    X[31] = (Y[30] + REDC(monty,(53 * Y[31])));
    Y[0] = X[0];
    Y[1] = X[1];
    Y[2] = X[2];
    Y[3] = X[3];
    Y[4] = X[4];
    Y[5] = X[5];
    Y[6] = X[6];
    Y[7] = X[7];
    Y[8] = X[8];
    Y[9] = X[9];
    Y[10] = X[10];
    Y[11] = X[11];
    Y[12] = X[12];
    Y[13] = X[13];
    Y[14] = X[14];
    Y[15] = X[15];
    Y[16] = X[16];
    Y[17] = X[17];
    Y[18] = X[18];
    Y[19] = X[19];
    Y[20] = X[20];
    Y[21] = X[21];
    Y[22] = X[22];
    Y[23] = X[23];
    Y[24] = X[24];
    Y[25] = X[25];
    Y[26] = X[26];
    Y[27] = X[27];
    Y[28] = X[28];
    Y[29] = X[29];
    Y[30] = X[30];
    Y[31] = X[31];

}

void inverse_path(int* X,int* Y,monty_str* monty){
    Y[0] = X[0];
    Y[1] = X[1];
    Y[2] = X[2];
    Y[3] = X[3];
    Y[4] = X[4];
    Y[5] = X[5];
    Y[6] = X[6];
    Y[7] = X[7];
    Y[8] = X[8];
    Y[9] = X[9];
    Y[10] = X[10];
    Y[11] = X[11];
    Y[12] = X[12];
    Y[13] = X[13];
    Y[14] = X[14];
    Y[15] = X[15];
    Y[16] = X[16];
    Y[17] = X[17];
    Y[18] = X[18];
    Y[19] = X[19];
    Y[20] = X[20];
    Y[21] = X[21];
    Y[22] = X[22];
    Y[23] = X[23];
    Y[24] = X[24];
    Y[25] = X[25];
    Y[26] = X[26];
    Y[27] = X[27];
    Y[28] = X[28];
    Y[29] = X[29];
    Y[30] = X[30];
    Y[31] = X[31];
    X[0] = Y[0];
    X[1] = Y[1];
    X[2] = Y[2];
    X[3] = Y[3];
    X[4] = Y[4];
    X[5] = Y[5];
    X[6] = Y[6];
    X[7] = Y[7];
    X[8] = Y[8];
    X[9] = Y[9];
    X[10] = Y[10];
    X[11] = Y[11];
    X[12] = Y[12];
    X[13] = Y[13];
    X[14] = Y[14];
    X[15] = Y[15];
    X[16] = Y[16];
    X[17] = Y[17];
    X[18] = Y[18];
    X[19] = Y[19];
    X[20] = Y[20];
    X[21] = Y[21];
    X[22] = Y[22];
    X[23] = Y[23];
    X[24] = Y[24];
    X[25] = Y[25];
    X[26] = Y[26];
    X[27] = Y[27];
    X[28] = Y[28];
    X[29] = Y[29];
    X[30] = Y[30];
    X[31] = Y[31];
    Y[0] = (REDC(monty,(128 * X[0])) + REDC(monty,(128 * X[1])));
    Y[1] = (REDC(monty,(123 * X[0])) + REDC(monty,(70 * X[1])));
    Y[2] = (REDC(monty,(128 * X[2])) + REDC(monty,(128 * X[3])));
    Y[3] = (REDC(monty,(120 * X[2])) + REDC(monty,(73 * X[3])));
    Y[4] = (REDC(monty,(128 * X[4])) + REDC(monty,(128 * X[5])));
    Y[5] = (REDC(monty,(142 * X[4])) + REDC(monty,(51 * X[5])));
    Y[6] = (REDC(monty,(128 * X[6])) + REDC(monty,(128 * X[7])));
    Y[7] = (REDC(monty,(115 * X[6])) + REDC(monty,(78 * X[7])));
    Y[8] = (REDC(monty,(128 * X[8])) + REDC(monty,(128 * X[9])));
    Y[9] = (REDC(monty,(17 * X[8])) + REDC(monty,(176 * X[9])));
    Y[10] = (REDC(monty,(128 * X[10])) + REDC(monty,(128 * X[11])));
    Y[11] = (REDC(monty,(26 * X[10])) + REDC(monty,(167 * X[11])));
    Y[12] = (REDC(monty,(128 * X[12])) + REDC(monty,(128 * X[13])));
    Y[13] = (REDC(monty,(153 * X[12])) + REDC(monty,(40 * X[13])));
    Y[14] = (REDC(monty,(128 * X[14])) + REDC(monty,(128 * X[15])));
    Y[15] = (REDC(monty,(41 * X[14])) + REDC(monty,(152 * X[15])));
    Y[16] = (REDC(monty,(128 * X[16])) + REDC(monty,(128 * X[17])));
    Y[17] = (REDC(monty,(57 * X[16])) + REDC(monty,(136 * X[17])));
    Y[18] = (REDC(monty,(128 * X[18])) + REDC(monty,(128 * X[19])));
    Y[19] = (REDC(monty,(178 * X[18])) + REDC(monty,(15 * X[19])));
    Y[20] = (REDC(monty,(128 * X[20])) + REDC(monty,(128 * X[21])));
    Y[21] = (REDC(monty,(127 * X[20])) + REDC(monty,(66 * X[21])));
    Y[22] = (REDC(monty,(128 * X[22])) + REDC(monty,(128 * X[23])));
    Y[23] = (REDC(monty,(58 * X[22])) + REDC(monty,(135 * X[23])));
    Y[24] = (REDC(monty,(128 * X[24])) + REDC(monty,(128 * X[25])));
    Y[25] = (REDC(monty,(22 * X[24])) + REDC(monty,(171 * X[25])));
    Y[26] = (REDC(monty,(128 * X[26])) + REDC(monty,(128 * X[27])));
    Y[27] = (REDC(monty,(45 * X[26])) + REDC(monty,(148 * X[27])));
    Y[28] = (REDC(monty,(128 * X[28])) + REDC(monty,(128 * X[29])));
    Y[29] = (REDC(monty,(5 * X[28])) + REDC(monty,(188 * X[29])));
    Y[30] = (REDC(monty,(128 * X[30])) + REDC(monty,(128 * X[31])));
    Y[31] = (REDC(monty,(19 * X[30])) + REDC(monty,(174 * X[31])));
    X[0] = (REDC(monty,(128 * Y[0])) + REDC(monty,(128 * Y[2])));
    X[2] = (REDC(monty,(177 * Y[0])) + REDC(monty,(16 * Y[2])));
    X[1] = (REDC(monty,(128 * Y[1])) + REDC(monty,(128 * Y[3])));
    X[3] = (REDC(monty,(177 * Y[1])) + REDC(monty,(16 * Y[3])));
    X[4] = (REDC(monty,(128 * Y[4])) + REDC(monty,(128 * Y[6])));
    X[6] = (REDC(monty,(55 * Y[4])) + REDC(monty,(138 * Y[6])));
    X[5] = (REDC(monty,(128 * Y[5])) + REDC(monty,(128 * Y[7])));
    X[7] = (REDC(monty,(55 * Y[5])) + REDC(monty,(138 * Y[7])));
    X[8] = (REDC(monty,(128 * Y[8])) + REDC(monty,(128 * Y[10])));
    X[10] = (REDC(monty,(49 * Y[8])) + REDC(monty,(144 * Y[10])));
    X[9] = (REDC(monty,(128 * Y[9])) + REDC(monty,(128 * Y[11])));
    X[11] = (REDC(monty,(49 * Y[9])) + REDC(monty,(144 * Y[11])));
    X[12] = (REDC(monty,(128 * Y[12])) + REDC(monty,(128 * Y[14])));
    X[14] = (REDC(monty,(109 * Y[12])) + REDC(monty,(84 * Y[14])));
    X[13] = (REDC(monty,(128 * Y[13])) + REDC(monty,(128 * Y[15])));
    X[15] = (REDC(monty,(109 * Y[13])) + REDC(monty,(84 * Y[15])));
    X[16] = (REDC(monty,(128 * Y[16])) + REDC(monty,(128 * Y[18])));
    X[18] = (REDC(monty,(48 * Y[16])) + REDC(monty,(145 * Y[18])));
    X[17] = (REDC(monty,(128 * Y[17])) + REDC(monty,(128 * Y[19])));
    X[19] = (REDC(monty,(48 * Y[17])) + REDC(monty,(145 * Y[19])));
    X[20] = (REDC(monty,(128 * Y[20])) + REDC(monty,(128 * Y[22])));
    X[22] = (REDC(monty,(28 * Y[20])) + REDC(monty,(165 * Y[22])));
    X[21] = (REDC(monty,(128 * Y[21])) + REDC(monty,(128 * Y[23])));
    X[23] = (REDC(monty,(28 * Y[21])) + REDC(monty,(165 * Y[23])));
    X[24] = (REDC(monty,(128 * Y[24])) + REDC(monty,(128 * Y[26])));
    X[26] = (REDC(monty,(46 * Y[24])) + REDC(monty,(147 * Y[26])));
    X[25] = (REDC(monty,(128 * Y[25])) + REDC(monty,(128 * Y[27])));
    X[27] = (REDC(monty,(46 * Y[25])) + REDC(monty,(147 * Y[27])));
    X[28] = (REDC(monty,(128 * Y[28])) + REDC(monty,(128 * Y[30])));
    X[30] = (REDC(monty,(59 * Y[28])) + REDC(monty,(134 * Y[30])));
    X[29] = (REDC(monty,(128 * Y[29])) + REDC(monty,(128 * Y[31])));
    X[31] = (REDC(monty,(59 * Y[29])) + REDC(monty,(134 * Y[31])));
    Y[0] = X[0];
    Y[1] = X[1];
    Y[2] = X[2];
    Y[3] = X[3];
    Y[4] = X[4];
    Y[5] = X[5];
    Y[6] = X[6];
    Y[7] = X[7];
    Y[8] = X[8];
    Y[9] = X[9];
    Y[10] = X[10];
    Y[11] = X[11];
    Y[12] = X[12];
    Y[13] = X[13];
    Y[14] = X[14];
    Y[15] = X[15];
    Y[16] = X[16];
    Y[17] = X[17];
    Y[18] = X[18];
    Y[19] = X[19];
    Y[20] = X[20];
    Y[21] = X[21];
    Y[22] = X[22];
    Y[23] = X[23];
    Y[24] = X[24];
    Y[25] = X[25];
    Y[26] = X[26];
    Y[27] = X[27];
    Y[28] = X[28];
    Y[29] = X[29];
    Y[30] = X[30];
    Y[31] = X[31];
    X[0] = (REDC(monty,(128 * Y[0])) + REDC(monty,(128 * Y[4])));
    X[4] = (REDC(monty,(2 * Y[0])) + REDC(monty,(191 * Y[4])));
    X[1] = (REDC(monty,(128 * Y[1])) + REDC(monty,(128 * Y[5])));
    X[5] = (REDC(monty,(2 * Y[1])) + REDC(monty,(191 * Y[5])));
    X[2] = (REDC(monty,(128 * Y[2])) + REDC(monty,(128 * Y[6])));
    X[6] = (REDC(monty,(2 * Y[2])) + REDC(monty,(191 * Y[6])));
    X[3] = (REDC(monty,(128 * Y[3])) + REDC(monty,(128 * Y[7])));
    X[7] = (REDC(monty,(2 * Y[3])) + REDC(monty,(191 * Y[7])));
    X[8] = (REDC(monty,(128 * Y[8])) + REDC(monty,(128 * Y[12])));
    X[12] = (REDC(monty,(162 * Y[8])) + REDC(monty,(31 * Y[12])));
    X[9] = (REDC(monty,(128 * Y[9])) + REDC(monty,(128 * Y[13])));
    X[13] = (REDC(monty,(162 * Y[9])) + REDC(monty,(31 * Y[13])));
    X[10] = (REDC(monty,(128 * Y[10])) + REDC(monty,(128 * Y[14])));
    X[14] = (REDC(monty,(162 * Y[10])) + REDC(monty,(31 * Y[14])));
    X[11] = (REDC(monty,(128 * Y[11])) + REDC(monty,(128 * Y[15])));
    X[15] = (REDC(monty,(162 * Y[11])) + REDC(monty,(31 * Y[15])));
    X[16] = (REDC(monty,(128 * Y[16])) + REDC(monty,(128 * Y[20])));
    X[20] = (REDC(monty,(18 * Y[16])) + REDC(monty,(175 * Y[20])));
    X[17] = (REDC(monty,(128 * Y[17])) + REDC(monty,(128 * Y[21])));
    X[21] = (REDC(monty,(18 * Y[17])) + REDC(monty,(175 * Y[21])));
    X[18] = (REDC(monty,(128 * Y[18])) + REDC(monty,(128 * Y[22])));
    X[22] = (REDC(monty,(18 * Y[18])) + REDC(monty,(175 * Y[22])));
    X[19] = (REDC(monty,(128 * Y[19])) + REDC(monty,(128 * Y[23])));
    X[23] = (REDC(monty,(18 * Y[19])) + REDC(monty,(175 * Y[23])));
    X[24] = (REDC(monty,(128 * Y[24])) + REDC(monty,(128 * Y[28])));
    X[28] = (REDC(monty,(107 * Y[24])) + REDC(monty,(86 * Y[28])));
    X[25] = (REDC(monty,(128 * Y[25])) + REDC(monty,(128 * Y[29])));
    X[29] = (REDC(monty,(107 * Y[25])) + REDC(monty,(86 * Y[29])));
    X[26] = (REDC(monty,(128 * Y[26])) + REDC(monty,(128 * Y[30])));
    X[30] = (REDC(monty,(107 * Y[26])) + REDC(monty,(86 * Y[30])));
    X[27] = (REDC(monty,(128 * Y[27])) + REDC(monty,(128 * Y[31])));
    X[31] = (REDC(monty,(107 * Y[27])) + REDC(monty,(86 * Y[31])));
    Y[0] = X[0];
    Y[1] = X[1];
    Y[2] = X[2];
    Y[3] = X[3];
    Y[4] = X[4];
    Y[5] = X[5];
    Y[6] = X[6];
    Y[7] = X[7];
    Y[8] = X[8];
    Y[9] = X[9];
    Y[10] = X[10];
    Y[11] = X[11];
    Y[12] = X[12];
    Y[13] = X[13];
    Y[14] = X[14];
    Y[15] = X[15];
    Y[16] = X[16];
    Y[17] = X[17];
    Y[18] = X[18];
    Y[19] = X[19];
    Y[20] = X[20];
    Y[21] = X[21];
    Y[22] = X[22];
    Y[23] = X[23];
    Y[24] = X[24];
    Y[25] = X[25];
    Y[26] = X[26];
    Y[27] = X[27];
    Y[28] = X[28];
    Y[29] = X[29];
    Y[30] = X[30];
    Y[31] = X[31];
    X[0] = (REDC(monty,(128 * Y[0])) + REDC(monty,(128 * Y[8])));
    X[8] = (REDC(monty,(187 * Y[0])) + REDC(monty,(6 * Y[8])));
    X[1] = (REDC(monty,(128 * Y[1])) + REDC(monty,(128 * Y[9])));
    X[9] = (REDC(monty,(187 * Y[1])) + REDC(monty,(6 * Y[9])));
    X[2] = (REDC(monty,(128 * Y[2])) + REDC(monty,(128 * Y[10])));
    X[10] = (REDC(monty,(187 * Y[2])) + REDC(monty,(6 * Y[10])));
    X[3] = (REDC(monty,(128 * Y[3])) + REDC(monty,(128 * Y[11])));
    X[11] = (REDC(monty,(187 * Y[3])) + REDC(monty,(6 * Y[11])));
    X[4] = (REDC(monty,(128 * Y[4])) + REDC(monty,(128 * Y[12])));
    X[12] = (REDC(monty,(187 * Y[4])) + REDC(monty,(6 * Y[12])));
    X[5] = (REDC(monty,(128 * Y[5])) + REDC(monty,(128 * Y[13])));
    X[13] = (REDC(monty,(187 * Y[5])) + REDC(monty,(6 * Y[13])));
    X[6] = (REDC(monty,(128 * Y[6])) + REDC(monty,(128 * Y[14])));
    X[14] = (REDC(monty,(187 * Y[6])) + REDC(monty,(6 * Y[14])));
    X[7] = (REDC(monty,(128 * Y[7])) + REDC(monty,(128 * Y[15])));
    X[15] = (REDC(monty,(187 * Y[7])) + REDC(monty,(6 * Y[15])));
    X[16] = (REDC(monty,(128 * Y[16])) + REDC(monty,(128 * Y[24])));
    X[24] = (REDC(monty,(93 * Y[16])) + REDC(monty,(100 * Y[24])));
    X[17] = (REDC(monty,(128 * Y[17])) + REDC(monty,(128 * Y[25])));
    X[25] = (REDC(monty,(93 * Y[17])) + REDC(monty,(100 * Y[25])));
    X[18] = (REDC(monty,(128 * Y[18])) + REDC(monty,(128 * Y[26])));
    X[26] = (REDC(monty,(93 * Y[18])) + REDC(monty,(100 * Y[26])));
    X[19] = (REDC(monty,(128 * Y[19])) + REDC(monty,(128 * Y[27])));
    X[27] = (REDC(monty,(93 * Y[19])) + REDC(monty,(100 * Y[27])));
    X[20] = (REDC(monty,(128 * Y[20])) + REDC(monty,(128 * Y[28])));
    X[28] = (REDC(monty,(93 * Y[20])) + REDC(monty,(100 * Y[28])));
    X[21] = (REDC(monty,(128 * Y[21])) + REDC(monty,(128 * Y[29])));
    X[29] = (REDC(monty,(93 * Y[21])) + REDC(monty,(100 * Y[29])));
    X[22] = (REDC(monty,(128 * Y[22])) + REDC(monty,(128 * Y[30])));
    X[30] = (REDC(monty,(93 * Y[22])) + REDC(monty,(100 * Y[30])));
    X[23] = (REDC(monty,(128 * Y[23])) + REDC(monty,(128 * Y[31])));
    X[31] = (REDC(monty,(93 * Y[23])) + REDC(monty,(100 * Y[31])));
    Y[0] = X[0];
    Y[1] = X[1];
    Y[2] = X[2];
    Y[3] = X[3];
    Y[4] = X[4];
    Y[5] = X[5];
    Y[6] = X[6];
    Y[7] = X[7];
    Y[8] = X[8];
    Y[9] = X[9];
    Y[10] = X[10];
    Y[11] = X[11];
    Y[12] = X[12];
    Y[13] = X[13];
    Y[14] = X[14];
    Y[15] = X[15];
    Y[16] = X[16];
    Y[17] = X[17];
    Y[18] = X[18];
    Y[19] = X[19];
    Y[20] = X[20];
    Y[21] = X[21];
    Y[22] = X[22];
    Y[23] = X[23];
    Y[24] = X[24];
    Y[25] = X[25];
    Y[26] = X[26];
    Y[27] = X[27];
    Y[28] = X[28];
    Y[29] = X[29];
    Y[30] = X[30];
    Y[31] = X[31];
    X[0] = Y[0];
    X[1] = Y[16];
    X[2] = Y[1];
    X[3] = Y[17];
    X[4] = Y[2];
    X[5] = Y[18];
    X[6] = Y[3];
    X[7] = Y[19];
    X[8] = Y[4];
    X[9] = Y[20];
    X[10] = Y[5];
    X[11] = Y[21];
    X[12] = Y[6];
    X[13] = Y[22];
    X[14] = Y[7];
    X[15] = Y[23];
    X[16] = Y[8];
    X[17] = Y[24];
    X[18] = Y[9];
    X[19] = Y[25];
    X[20] = Y[10];
    X[21] = Y[26];
    X[22] = Y[11];
    X[23] = Y[27];
    X[24] = Y[12];
    X[25] = Y[28];
    X[26] = Y[13];
    X[27] = Y[29];
    X[28] = Y[14];
    X[29] = Y[30];
    X[30] = Y[15];
    X[31] = Y[31];
    Y[0] = (REDC(monty,(128 * X[0])) + REDC(monty,(128 * X[1])));
    Y[1] = (REDC(monty,(139 * X[0])) + REDC(monty,(54 * X[1])));
    Y[2] = (REDC(monty,(128 * X[2])) + REDC(monty,(128 * X[3])));
    Y[3] = (REDC(monty,(139 * X[2])) + REDC(monty,(54 * X[3])));
    Y[4] = (REDC(monty,(128 * X[4])) + REDC(monty,(128 * X[5])));
    Y[5] = (REDC(monty,(139 * X[4])) + REDC(monty,(54 * X[5])));
    Y[6] = (REDC(monty,(128 * X[6])) + REDC(monty,(128 * X[7])));
    Y[7] = (REDC(monty,(139 * X[6])) + REDC(monty,(54 * X[7])));
    Y[8] = (REDC(monty,(128 * X[8])) + REDC(monty,(128 * X[9])));
    Y[9] = (REDC(monty,(139 * X[8])) + REDC(monty,(54 * X[9])));
    Y[10] = (REDC(monty,(128 * X[10])) + REDC(monty,(128 * X[11])));
    Y[11] = (REDC(monty,(139 * X[10])) + REDC(monty,(54 * X[11])));
    Y[12] = (REDC(monty,(128 * X[12])) + REDC(monty,(128 * X[13])));
    Y[13] = (REDC(monty,(139 * X[12])) + REDC(monty,(54 * X[13])));
    Y[14] = (REDC(monty,(128 * X[14])) + REDC(monty,(128 * X[15])));
    Y[15] = (REDC(monty,(139 * X[14])) + REDC(monty,(54 * X[15])));
    Y[16] = (REDC(monty,(128 * X[16])) + REDC(monty,(128 * X[17])));
    Y[17] = (REDC(monty,(139 * X[16])) + REDC(monty,(54 * X[17])));
    Y[18] = (REDC(monty,(128 * X[18])) + REDC(monty,(128 * X[19])));
    Y[19] = (REDC(monty,(139 * X[18])) + REDC(monty,(54 * X[19])));
    Y[20] = (REDC(monty,(128 * X[20])) + REDC(monty,(128 * X[21])));
    Y[21] = (REDC(monty,(139 * X[20])) + REDC(monty,(54 * X[21])));
    Y[22] = (REDC(monty,(128 * X[22])) + REDC(monty,(128 * X[23])));
    Y[23] = (REDC(monty,(139 * X[22])) + REDC(monty,(54 * X[23])));
    Y[24] = (REDC(monty,(128 * X[24])) + REDC(monty,(128 * X[25])));
    Y[25] = (REDC(monty,(139 * X[24])) + REDC(monty,(54 * X[25])));
    Y[26] = (REDC(monty,(128 * X[26])) + REDC(monty,(128 * X[27])));
    Y[27] = (REDC(monty,(139 * X[26])) + REDC(monty,(54 * X[27])));
    Y[28] = (REDC(monty,(128 * X[28])) + REDC(monty,(128 * X[29])));
    Y[29] = (REDC(monty,(139 * X[28])) + REDC(monty,(54 * X[29])));
    Y[30] = (REDC(monty,(128 * X[30])) + REDC(monty,(128 * X[31])));
    Y[31] = (REDC(monty,(139 * X[30])) + REDC(monty,(54 * X[31])));
    X[0] = Y[0];
    X[1] = Y[2];
    X[2] = Y[4];
    X[3] = Y[6];
    X[4] = Y[8];
    X[5] = Y[10];
    X[6] = Y[12];
    X[7] = Y[14];
    X[8] = Y[16];
    X[9] = Y[18];
    X[10] = Y[20];
    X[11] = Y[22];
    X[12] = Y[24];
    X[13] = Y[26];
    X[14] = Y[28];
    X[15] = Y[30];
    X[16] = Y[1];
    X[17] = Y[3];
    X[18] = Y[5];
    X[19] = Y[7];
    X[20] = Y[9];
    X[21] = Y[11];
    X[22] = Y[13];
    X[23] = Y[15];
    X[24] = Y[17];
    X[25] = Y[19];
    X[26] = Y[21];
    X[27] = Y[23];
    X[28] = Y[25];
    X[29] = Y[27];
    X[30] = Y[29];
    X[31] = Y[31];
    Y[0] = X[0];
    Y[1] = X[1];
    Y[2] = X[2];
    Y[3] = X[3];
    Y[4] = X[4];
    Y[5] = X[5];
    Y[6] = X[6];
    Y[7] = X[7];
    Y[8] = X[8];
    Y[9] = X[9];
    Y[10] = X[10];
    Y[11] = X[11];
    Y[12] = X[12];
    Y[13] = X[13];
    Y[14] = X[14];
    Y[15] = X[15];
    Y[16] = X[16];
    Y[17] = X[17];
    Y[18] = X[18];
    Y[19] = X[19];
    Y[20] = X[20];
    Y[21] = X[21];
    Y[22] = X[22];
    Y[23] = X[23];
    Y[24] = X[24];
    Y[25] = X[25];
    Y[26] = X[26];
    Y[27] = X[27];
    Y[28] = X[28];
    Y[29] = X[29];
    Y[30] = X[30];
    Y[31] = X[31];

}

void polymult(int* X,int* X_t,int* Y,int* Y_t,int* Z,int* Z_t,monty_str* monty){
  forward_path(X,X_t,monty);
  forward_path(Y,Y_t,monty);
  point_multiply_monty(32,X_t,Y_t,Z_t,monty);
  inverse_path(Z_t,Z,monty);
}

int main(int argc,char** argv){
    int* X = malloc(sizeof(int)*32);
    int* Y = malloc(sizeof(int)*32);
    int* Z = malloc(sizeof(int)*32);
    int* X_t = malloc(sizeof(int)*32);
    int* Y_t = malloc(sizeof(int)*32);
    int* Z_t = malloc(sizeof(int)*32);
    
    for(int i=0; i<32; i++){
      X[i]=i;
      Y[i]=i;
    }
    
    monty_str monty;
    monty_init(&monty,193,256,191,144,8);
    initialize_timer();
    start_timer();
    
    for(int i=0; i<32; i++){
    X[i] = toResidue(&monty,X[i]);
    Y[i] = toResidue(&monty,Y[i]);
    }
    
    polymult(X,X_t,Y,Y_t,Z,Z_t,&monty);
    
    for(int i=0; i<32; i++){
    Z[i] = fromResidue(&monty,Z[i]);
    }
    
    
    stop_timer();
    printf("Elapsed time: %f\n",elapsed_time());
    
    for(int i=0; i<32; i++){
      Z[i]=(((Z[i]+193)%193)+193)%193;
    }
    
    print_array("result",Z,32);
    
    free(X);
    free(Y);
    free(Z);
    free(X_t);
    free(Y_t);
    free(Z_t);
    

}

