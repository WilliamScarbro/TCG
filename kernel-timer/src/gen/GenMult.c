#include <stdio.h>
#include <stdlib.h>
#include "../Util.h"
#include "../timer.h"
#include "../Multiply.h"

void forward_path(int* X,int *Y){
    int t0;
    int t1;
    int t2;
    int t3;
    int t4;
    int t5;
    int t6;
    int t7;
    int t8;
    int t9;
    int t10;
    int t11;
    int t12;
    int t13;
    int t14;
    int t15;
    int t16;
    int t17;
    int t18;
    int t19;
    int t20;
    int t21;
    int t22;
    int t23;
    int t24;
    int t25;
    int t26;
    int t27;
    int t28;
    int t29;
    int t30;
    int t31;
    t0 = ((X[0] + ((X[2] + ((X[4] + ((X[6] + ((X[8] + ((X[10] + ((X[12] + X[14]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t2 = ((X[0] + ((((9 * X[2]) % 17) + ((((13 * X[4]) % 17) + ((((15 * X[6]) % 17) + ((((((8 * X[10]) % 17) + ((((4 * X[12]) % 17) + ((2 * X[14]) % 17)) % 17)) % 17) - X[8]) % 17)) % 17)) % 17)) % 17)) % 17);
    t4 = ((X[0] + ((((13 * X[2]) % 17) + ((((((4 * X[6]) % 17) + ((X[8] + ((((13 * X[10]) % 17) + ((((4 * X[14]) % 17) - X[12]) % 17)) % 17)) % 17)) % 17) - X[4]) % 17)) % 17)) % 17);
    t6 = ((X[0] + ((((15 * X[2]) % 17) + ((((4 * X[4]) % 17) + ((((9 * X[6]) % 17) + ((((((2 * X[10]) % 17) + ((((13 * X[12]) % 17) + ((8 * X[14]) % 17)) % 17)) % 17) - X[8]) % 17)) % 17)) % 17)) % 17)) % 17);
    t8 = ((X[0] + ((((X[4] + ((((X[8] + ((((X[12] - X[14]) % 17) - X[10]) % 17)) % 17) - X[6]) % 17)) % 17) - X[2]) % 17)) % 17);
    t10 = ((X[0] + ((((8 * X[2]) % 17) + ((((13 * X[4]) % 17) + ((((2 * X[6]) % 17) + ((((((9 * X[10]) % 17) + ((((4 * X[12]) % 17) + ((15 * X[14]) % 17)) % 17)) % 17) - X[8]) % 17)) % 17)) % 17)) % 17)) % 17);
    t12 = ((X[0] + ((((4 * X[2]) % 17) + ((((((13 * X[6]) % 17) + ((X[8] + ((((4 * X[10]) % 17) + ((((13 * X[14]) % 17) - X[12]) % 17)) % 17)) % 17)) % 17) - X[4]) % 17)) % 17)) % 17);
    t14 = ((X[0] + ((((2 * X[2]) % 17) + ((((4 * X[4]) % 17) + ((((8 * X[6]) % 17) + ((((((15 * X[10]) % 17) + ((((13 * X[12]) % 17) + ((9 * X[14]) % 17)) % 17)) % 17) - X[8]) % 17)) % 17)) % 17)) % 17)) % 17);
    t1 = ((X[1] + ((X[3] + ((X[5] + ((X[7] + ((X[9] + ((X[11] + ((X[13] + X[15]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t3 = ((X[1] + ((((9 * X[3]) % 17) + ((((13 * X[5]) % 17) + ((((15 * X[7]) % 17) + ((((((8 * X[11]) % 17) + ((((4 * X[13]) % 17) + ((2 * X[15]) % 17)) % 17)) % 17) - X[9]) % 17)) % 17)) % 17)) % 17)) % 17);
    t5 = ((X[1] + ((((13 * X[3]) % 17) + ((((((4 * X[7]) % 17) + ((X[9] + ((((13 * X[11]) % 17) + ((((4 * X[15]) % 17) - X[13]) % 17)) % 17)) % 17)) % 17) - X[5]) % 17)) % 17)) % 17);
    t7 = ((X[1] + ((((15 * X[3]) % 17) + ((((4 * X[5]) % 17) + ((((9 * X[7]) % 17) + ((((((2 * X[11]) % 17) + ((((13 * X[13]) % 17) + ((8 * X[15]) % 17)) % 17)) % 17) - X[9]) % 17)) % 17)) % 17)) % 17)) % 17);
    t9 = ((X[1] + ((((X[5] + ((((X[9] + ((((X[13] - X[15]) % 17) - X[11]) % 17)) % 17) - X[7]) % 17)) % 17) - X[3]) % 17)) % 17);
    t11 = ((X[1] + ((((8 * X[3]) % 17) + ((((13 * X[5]) % 17) + ((((2 * X[7]) % 17) + ((((((9 * X[11]) % 17) + ((((4 * X[13]) % 17) + ((15 * X[15]) % 17)) % 17)) % 17) - X[9]) % 17)) % 17)) % 17)) % 17)) % 17);
    t13 = ((X[1] + ((((4 * X[3]) % 17) + ((((((13 * X[7]) % 17) + ((X[9] + ((((4 * X[11]) % 17) + ((((13 * X[15]) % 17) - X[13]) % 17)) % 17)) % 17)) % 17) - X[5]) % 17)) % 17)) % 17);
    t15 = ((X[1] + ((((2 * X[3]) % 17) + ((((4 * X[5]) % 17) + ((((8 * X[7]) % 17) + ((((((15 * X[11]) % 17) + ((((13 * X[13]) % 17) + ((9 * X[15]) % 17)) % 17)) % 17) - X[9]) % 17)) % 17)) % 17)) % 17)) % 17);
    t16 = ((t0 + t1) % 17);
    t17 = ((t0 - t1) % 17);
    t18 = ((t2 + ((3 * t3) % 17)) % 17);
    t19 = ((t2 + ((14 * t3) % 17)) % 17);
    t20 = ((t4 + ((9 * t5) % 17)) % 17);
    t21 = ((t4 + ((8 * t5) % 17)) % 17);
    t22 = ((t6 + ((10 * t7) % 17)) % 17);
    t23 = ((t6 + ((7 * t7) % 17)) % 17);
    t24 = ((t8 + ((13 * t9) % 17)) % 17);
    t25 = ((t8 + ((4 * t9) % 17)) % 17);
    t26 = ((t10 + ((5 * t11) % 17)) % 17);
    t27 = ((t10 + ((12 * t11) % 17)) % 17);
    t28 = ((t12 + ((15 * t13) % 17)) % 17);
    t29 = ((t12 + ((2 * t13) % 17)) % 17);
    t30 = ((t14 + ((11 * t15) % 17)) % 17);
    t31 = ((t14 + ((6 * t15) % 17)) % 17);
    Y[0] = t16;
    Y[1] = t17;
    Y[2] = t18;
    Y[3] = t19;
    Y[4] = t20;
    Y[5] = t21;
    Y[6] = t22;
    Y[7] = t23;
    Y[8] = t24;
    Y[9] = t25;
    Y[10] = t26;
    Y[11] = t27;
    Y[12] = t28;
    Y[13] = t29;
    Y[14] = t30;
    Y[15] = t31;

}

void inverse_path(int* X,int *Y){
    int t0;
    int t1;
    int t2;
    int t3;
    int t4;
    int t5;
    int t6;
    int t7;
    int t8;
    int t9;
    int t10;
    int t11;
    int t12;
    int t13;
    int t14;
    int t15;
    int t16;
    int t17;
    int t18;
    int t19;
    int t20;
    int t21;
    int t22;
    int t23;
    int t24;
    int t25;
    int t26;
    int t27;
    int t28;
    int t29;
    int t30;
    int t31;
    int t32;
    int t33;
    int t34;
    int t35;
    int t36;
    int t37;
    int t38;
    int t39;
    int t40;
    int t41;
    int t42;
    int t43;
    int t44;
    int t45;
    int t46;
    int t47;
    t0 = ((((15 * X[0]) % 17) + ((((15 * X[2]) % 17) + ((((15 * X[4]) % 17) + ((((15 * X[6]) % 17) + ((((15 * X[8]) % 17) + ((((15 * X[10]) % 17) + ((((15 * X[12]) % 17) + ((15 * X[14]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t2 = ((((15 * X[0]) % 17) + ((((13 * X[2]) % 17) + ((((9 * X[4]) % 17) + ((X[6] + ((((2 * X[8]) % 17) + ((((4 * X[10]) % 17) + ((((8 * X[12]) % 17) - X[14]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t4 = ((((15 * X[0]) % 17) + ((((9 * X[2]) % 17) + ((((2 * X[4]) % 17) + ((((8 * X[6]) % 17) + ((((15 * X[8]) % 17) + ((((9 * X[10]) % 17) + ((((2 * X[12]) % 17) + ((8 * X[14]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t6 = ((((15 * X[0]) % 17) + ((X[2] + ((((8 * X[4]) % 17) + ((((13 * X[6]) % 17) + ((((2 * X[8]) % 17) + ((((((9 * X[12]) % 17) + ((4 * X[14]) % 17)) % 17) - X[10]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t8 = ((((15 * X[0]) % 17) + ((((2 * X[2]) % 17) + ((((15 * X[4]) % 17) + ((((2 * X[6]) % 17) + ((((15 * X[8]) % 17) + ((((2 * X[10]) % 17) + ((((15 * X[12]) % 17) + ((2 * X[14]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t10 = ((((15 * X[0]) % 17) + ((((4 * X[2]) % 17) + ((((9 * X[4]) % 17) + ((((((2 * X[8]) % 17) + ((((13 * X[10]) % 17) + ((((8 * X[12]) % 17) + X[14]) % 17)) % 17)) % 17) - X[6]) % 17)) % 17)) % 17)) % 17);
    t12 = ((((15 * X[0]) % 17) + ((((8 * X[2]) % 17) + ((((2 * X[4]) % 17) + ((((9 * X[6]) % 17) + ((((15 * X[8]) % 17) + ((((8 * X[10]) % 17) + ((((2 * X[12]) % 17) + ((9 * X[14]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t14 = ((((15 * X[0]) % 17) + ((((((8 * X[4]) % 17) + ((((4 * X[6]) % 17) + ((((2 * X[8]) % 17) + ((X[10] + ((((9 * X[12]) % 17) + ((13 * X[14]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17) - X[2]) % 17)) % 17);
    t1 = ((((15 * X[1]) % 17) + ((((15 * X[3]) % 17) + ((((15 * X[5]) % 17) + ((((15 * X[7]) % 17) + ((((15 * X[9]) % 17) + ((((15 * X[11]) % 17) + ((((15 * X[13]) % 17) + ((15 * X[15]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t3 = ((((15 * X[1]) % 17) + ((((13 * X[3]) % 17) + ((((9 * X[5]) % 17) + ((X[7] + ((((2 * X[9]) % 17) + ((((4 * X[11]) % 17) + ((((8 * X[13]) % 17) - X[15]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t5 = ((((15 * X[1]) % 17) + ((((9 * X[3]) % 17) + ((((2 * X[5]) % 17) + ((((8 * X[7]) % 17) + ((((15 * X[9]) % 17) + ((((9 * X[11]) % 17) + ((((2 * X[13]) % 17) + ((8 * X[15]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t7 = ((((15 * X[1]) % 17) + ((X[3] + ((((8 * X[5]) % 17) + ((((13 * X[7]) % 17) + ((((2 * X[9]) % 17) + ((((((9 * X[13]) % 17) + ((4 * X[15]) % 17)) % 17) - X[11]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t9 = ((((15 * X[1]) % 17) + ((((2 * X[3]) % 17) + ((((15 * X[5]) % 17) + ((((2 * X[7]) % 17) + ((((15 * X[9]) % 17) + ((((2 * X[11]) % 17) + ((((15 * X[13]) % 17) + ((2 * X[15]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t11 = ((((15 * X[1]) % 17) + ((((4 * X[3]) % 17) + ((((9 * X[5]) % 17) + ((((((2 * X[9]) % 17) + ((((13 * X[11]) % 17) + ((((8 * X[13]) % 17) + X[15]) % 17)) % 17)) % 17) - X[7]) % 17)) % 17)) % 17)) % 17);
    t13 = ((((15 * X[1]) % 17) + ((((8 * X[3]) % 17) + ((((2 * X[5]) % 17) + ((((9 * X[7]) % 17) + ((((15 * X[9]) % 17) + ((((8 * X[11]) % 17) + ((((2 * X[13]) % 17) + ((9 * X[15]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17)) % 17);
    t15 = ((((15 * X[1]) % 17) + ((((((8 * X[5]) % 17) + ((((4 * X[7]) % 17) + ((((2 * X[9]) % 17) + ((X[11] + ((((9 * X[13]) % 17) + ((13 * X[15]) % 17)) % 17)) % 17)) % 17)) % 17)) % 17) - X[3]) % 17)) % 17);
    t16 = ((t0 + t1) % 17);
    t17 = ((t0 - t1) % 17);
    t18 = ((t2 + ((3 * t3) % 17)) % 17);
    t19 = ((t2 + ((14 * t3) % 17)) % 17);
    t20 = ((t4 + ((9 * t5) % 17)) % 17);
    t21 = ((t4 + ((8 * t5) % 17)) % 17);
    t22 = ((t6 + ((10 * t7) % 17)) % 17);
    t23 = ((t6 + ((7 * t7) % 17)) % 17);
    t24 = ((t8 + ((13 * t9) % 17)) % 17);
    t25 = ((t8 + ((4 * t9) % 17)) % 17);
    t26 = ((t10 + ((5 * t11) % 17)) % 17);
    t27 = ((t10 + ((12 * t11) % 17)) % 17);
    t28 = ((t12 + ((15 * t13) % 17)) % 17);
    t29 = ((t12 + ((2 * t13) % 17)) % 17);
    t30 = ((t14 + ((11 * t15) % 17)) % 17);
    t31 = ((t14 + ((6 * t15) % 17)) % 17);
    t32 = t16;
    t33 = t17;
    t34 = t18;
    t35 = t19;
    t36 = t20;
    t37 = t21;
    t38 = t22;
    t39 = t23;
    t40 = t24;
    t41 = t25;
    t42 = t26;
    t43 = t27;
    t44 = t28;
    t45 = t29;
    t46 = t30;
    t47 = t31;
    Y[0] = t32;
    Y[1] = t33;
    Y[2] = t34;
    Y[3] = t35;
    Y[4] = t36;
    Y[5] = t37;
    Y[6] = t38;
    Y[7] = t39;
    Y[8] = t40;
    Y[9] = t41;
    Y[10] = t42;
    Y[11] = t43;
    Y[12] = t44;
    Y[13] = t45;
    Y[14] = t46;
    Y[15] = t47;

}

void polymult(int* X,int* X_t,int* Y,int* Y_t,int* Z,int* Z_t){
  forward_path(X,X_t);
  forward_path(Y,Y_t);
  point_multiply(16,X_t,Y_t,Z_t);
  inverse_path(Z_t,Z);
}

int main(int argc,char** argv){
    int* X = malloc(sizeof(int)*16);
    int* Y = malloc(sizeof(int)*16);
    int* Z = malloc(sizeof(int)*16);
    int* X_t = malloc(sizeof(int)*16);
    int* Y_t = malloc(sizeof(int)*16);
    int* Z_t = malloc(sizeof(int)*16);
    
    for(int i=0; i<16; i++){
      X[i]=i;
      Y[i]=i;
    }
    
    initialize_timer();
    start_timer();
    
    polymult(X,X_t,Y,Y_t,Z,Z_t);
    
    stop_timer();
    printf("Elapsed time: %f\n",elapsed_time());
    
    for(int i=0; i<16; i++){
      Z[i]=(((Z[i]+17)%17)+17)%17;
    }
    
    print_array("result",Z,16);
    
    free(X);
    free(Y);
    free(Z);
    free(X_t);
    free(Y_t);
    free(Z_t);
    

}

